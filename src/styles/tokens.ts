export const tokens = {
  // color tokens
  backgroundRoot: "var(--background-root)",
  backgroundDefault: "var(--background-default)",
  backgroundHigher: "var(--background-higher)",
  backgroundHighest: "var(--background-highest)",
  backgroundOverlay: "var(--background-overlay)",
  foregroundDefault: "var(--foreground-default)",
  foregroundDimmer: "var(--foreground-dimmer)",
  foregroundDimmest: "var(--foreground-dimmest)",
  outlineDimmest: "var(--outline-dimmest)",
  outlineDimmer: "var(--outline-dimmer)",
  outlineDefault: "var(--outline-default)",
  outlineStronger: "var(--outline-stronger)",
  outlineStrongest: "var(--outline-strongest)",
  primaryDimmest: "var(--primary-dimmest)",
  primaryDimmer: "var(--primary-dimmer)",
  primaryDefault: "var(--primary-default)",
  primaryStronger: "var(--primary-stronger)",
  primaryStrongest: "var(--primary-strongest)",
  positiveDimmest: "var(--positive-dimmest)",
  positiveDimmer: "var(--positive-dimmer)",
  positiveDefault: "var(--positive-default)",
  positiveStronger: "var(--positive-stronger)",
  positiveStrongest: "var(--positive-strongest)",
  negativeDimmest: "var(--negative-dimmest)",
  negativeDimmer: "var(--negative-dimmer)",
  negativeDefault: "var(--negative-default)",
  negativeStronger: "var(--negative-stronger)",
  negativeStrongest: "var(--negative-strongest)",
  redDimmest: "var(--red-dimmest)",
  redDimmer: "var(--red-dimmer)",
  redDefault: "var(--red-default)",
  redStronger: "var(--red-stronger)",
  redStrongest: "var(--red-strongest)",
  orangeDimmest: "var(--orange-dimmest)",
  orangeDimmer: "var(--orange-dimmer)",
  orangeDefault: "var(--orange-default)",
  orangeStronger: "var(--orange-stronger)",
  orangeStrongest: "var(--orange-strongest)",
  yellowDimmest: "var(--yellow-dimmest)",
  yellowDimmer: "var(--yellow-dimmer)",
  yellowDefault: "var(--yellow-default)",
  yellowStronger: "var(--yellow-stronger)",
  yellowStrongest: "var(--yellow-strongest)",
  limeDimmest: "var(--lime-dimmest)",
  limeDimmer: "var(--lime-dimmer)",
  limeDefault: "var(--lime-default)",
  limeStronger: "var(--lime-stronger)",
  limeStrongest: "var(--lime-strongest)",
  greenDimmest: "var(--green-dimmest)",
  greenDimmer: "var(--green-dimmer)",
  greenDefault: "var(--green-default)",
  greenStronger: "var(--green-stronger)",
  greenStrongest: "var(--green-strongest)",
  tealDimmest: "var(--teal-dimmest)",
  tealDimmer: "var(--teal-dimmer)",
  tealDefault: "var(--teal-default)",
  tealStronger: "var(--teal-stronger)",
  tealStrongest: "var(--teal-strongest)",
  blueDimmest: "var(--blue-dimmest)",
  blueDimmer: "var(--blue-dimmer)",
  blueDefault: "var(--blue-default)",
  blueStronger: "var(--blue-stronger)",
  blueStrongest: "var(--blue-strongest)",
  blurpleDimmest: "var(--blurple-dimmest)",
  blurpleDimmer: "var(--blurple-dimmer)",
  blurpleDefault: "var(--blurple-default)",
  blurpleStronger: "var(--blurple-stronger)",
  blurpleStrongest: "var(--blurple-strongest)",
  purpleDimmest: "var(--purple-dimmest)",
  purpleDimmer: "var(--purple-dimmer)",
  purpleDefault: "var(--purple-default)",
  purpleStronger: "var(--purple-stronger)",
  purpleStrongest: "var(--purple-strongest)",
  magentaDimmest: "var(--magenta-dimmest)",
  magentaDimmer: "var(--magenta-dimmer)",
  magentaDefault: "var(--magenta-default)",
  magentaStronger: "var(--magenta-stronger)",
  magentaStrongest: "var(--magenta-strongest)",
  pinkDimmest: "var(--pink-dimmest)",
  pinkDimmer: "var(--pink-dimmer)",
  pinkDefault: "var(--pink-default)",
  pinkStronger: "var(--pink-stronger)",
  pinkStrongest: "var(--pink-strongest)",
  greyDimmest: "var(--grey-dimmest)",
  greyDimmer: "var(--grey-dimmer)",
  greyDefault: "var(--grey-default)",
  greyStronger: "var(--grey-stronger)",
  greyStrongest: "var(--grey-strongest)",
  brownDimmest: "var(--brown-dimmest)",
  brownDimmer: "var(--brown-dimmer)",
  brownDefault: "var(--brown-default)",
  brownStronger: "var(--brown-stronger)",
  brownStrongest: "var(--brown-strongest)",
  black: "var(--black)",
  white: "var(--white)",

  // interactive tokens
  surfaceBackground: "var(--surface-background)",
  interactiveBackground: "var(--surface-interactive-background)",
  interactiveBackgroundActive: "var(--surface-interactive-background-active)",
  interactiveBorder: "var(--surface-interactive-border)",
  interactiveBorderHover: "var(--surface-interactive-border-hover)",

  // colorway tokens
  colorwayDimmest: "var(--view-colorway-dimmest)",
  colorwayDimmer: "var(--view-colorway-dimmer)",
  colorwayDefault: "var(--view-colorway-default)",
  colorwayStronger: "var(--view-colorway-stronger)",
  colorwayStrongest: "var(--view-colorway-strongest)",

  // space tokens
  space1: "var(--space-1)",
  space2: "var(--space-2)",
  space4: "var(--space-4)",
  space6: "var(--space-6)",
  space8: "var(--space-8)",
  space12: "var(--space-12)",
  space16: "var(--space-16)",
  space20: "var(--space-20)",
  space24: "var(--space-24)",
  space28: "var(--space-28)",
  space32: "var(--space-32)",
  space40: "var(--space-40)",
  space48: "var(--space-48)",
  space56: "var(--space-56)",
  space64: "var(--space-64)",
  space80: "var(--space-80)",
  space96: "var(--space-96)",
  space128: "var(--space-128)",
  space256: "var(--space-256)",
  spaceDefault: "var(--space-default)",

  // border radius tokens
  borderRadius1: "var(--border-radius-1)",
  borderRadius2: "var(--border-radius-2)",
  borderRadius4: "var(--border-radius-4)",
  borderRadius6: "var(--border-radius-6)",
  borderRadius8: "var(--border-radius-8)",
  borderRadius12: "var(--border-radius-12)",
  borderRadius16: "var(--border-radius-16)",
  borderRadiusDefault: "var(--border-radius-default)",
  borderRadiusRound: "var(--border-radius-round)",

  // shadow tokens
  shadow1: "var(--shadow-1)",
  shadow2: "var(--shadow-2)",
  shadow3: "var(--shadow-3)",
  shadowDefault: "var(--shadow-default)",
  shadowFocus: "var(--shadow-focus)",

  // typography tokens
  fontFamilyDefault: "var(--font-family-default)",
  fontFamilyCode: "var(--font-family-code)",

  fontSizeSmall: "var(--font-size-small)",
  fontSizeDefault: "var(--font-size-default)",
  fontSizeSubheadDefault: "var(--font-size-subhead-default)",
  fontSizeSubheadBig: "var(--font-size-subhead-big)",
  fontSizeHeaderDefault: "var(--font-size-header-default)",
  fontSizeHeaderBig: "var(--font-size-header-big)",

  lineHeightSmall: "var(--line-height-small)",
  lineHeightDefault: "var(--line-height-default)",
  lineHeightSubheadDefault: "var(--line-height-subhead-default)",
  lineHeightSubheadBig: "var(--line-height-subhead-big)",
  lineHeightHeaderDefault: "var(--line-height-header-default)",
  lineHeightHeaderBig: "var(--line-height-header-big)",
  lineHeightSingle: "var(--line-height-single)",
  lineHeightInput: "var(--line-height-input)",

  fontWeightRegular: "var(--font-weight-regular)",
  fontWeightMedium: "var(--font-weight-medium)",
  fontWeightBold: "var(--font-weight-bold)",

  // transition tokens
  transitionDurationSnappy: "var(--transition-duration-snappy)",
  transitionTimingFunctionSnappy: "var(--transition-timing-function-snappy)",
  transitionDurationChill: "var(--transition-duration-chill)",
  transitionTimingFunctionChill: "var(--transition-timing-function-chill)",

  borderWidthDefault: "var(--border-width-default)",
} as const;

/**
 * Convert a css variable (a token) into the key needed to set a style \
 * It will simply return the style key if the argument was a style key
 * @param token CSS variable
 * @returns Style key
 *
 * @example
 * const style = {
 *   [tokenToStyle(tokens.space2)]: "override"
 * }
 *
 * @example
 * tokenToStyle("var(--space-2)") // => --space-2
 * tokenToStyle("--space-2") // => --space-2
 */
function tokenToStyle(token: string) {
  return token.startsWith("var") ? token.substring(4, token.length - 1) : token;
}

/**
 * Convert a css variable (a token) into its JavaScript counterpart \
 * @param token CSS variable (or style, to be fair)
 * @returns JS Token, if valid
 *
 * @example
 * tokenToJS("var(--border-radius-2)") // => borderRadius2
 */
function tokenToJS(token: string) {
  const jsToken = tokenToStyle(token)
    .substring(2)
    .split("-")
    .map((word, i) =>
      i > 0 ? word.charAt(0).toLocaleUpperCase() + word.substring(1) : word,
    )
    .join("");

  return jsToken in tokens ? (jsToken as keyof typeof tokens) : null;
}

/**
 * Get the raw CSS value of a token \
 * Can be slow because a raw token that isn't found will be extracted from the DOM \
 * Only use on the client
 * @param token Token or style key to use
 * @param element Element to extract variable from (interactive and colorway variables can change depending on nesting, for example)
 * @returns Raw CSS value
 */
export function getTokenValue(token: string, element?: HTMLElement) {
  const jsToken = tokenToJS(token);
  if (jsToken && jsToken in rawTokenValues) {
    const rawToken = rawTokenValues[jsToken as keyof typeof rawTokenValues];
    if (typeof rawToken === "number") {
      return `${rawToken}px`;
    }
    return rawToken;
  }

  // Supposedly this is decently fast?
  // https://stackoverflow.com/questions/57393554/getcomputedstyle-local-vs-every-time-in-function-performance
  if (typeof window !== "undefined") {
    return getComputedStyle(
      element || document.documentElement,
    ).getPropertyValue(tokenToStyle(token));
  }

  console.error("you shouldn't use tokenToRaw in server side environments!");
  return token;
}

// @todo raw tokens without tokenToRaw at all (generation + server adapter?)

// color tokens depend on theming and cannot be reliably used w/out server implementation
// use subset and then getComputedStyle as fallback
export const rawTokenValues = {
  borderRadius1: 1,
  borderRadius2: 2,
  borderRadius4: 4,
  borderRadius6: 6,
  borderRadius8: 8,
  borderRadius12: 12,
  borderRadius16: 16,
  borderRadiusDefault: 8,
  borderRadiusRound: 1028,
  space1: 1,
  space2: 2,
  space4: 4,
  space6: 6,
  space8: 8,
  space12: 12,
  space16: 16,
  space20: 20,
  space24: 24,
  space28: 28,
  space32: 32,
  space40: 40,
  space48: 48,
  space56: 56,
  space64: 64,
  space80: 80,
  space96: 96,
  space128: 128,
  space256: 256,
  spaceDefault: 8,
} as const;
